---
layout: post
title: LibraBFT中文翻译
tags: 
- 共识协议
- LibraBFT
categories: 区块链
---
* TOC
{:toc}

摘要。 本报告介绍了LibraBFT，这是一个针对Libra Blockchain设计的强大而高效的状态机复制系统。 LibraBFT基于HotStuff，这是最近的一项协议，利用拜占庭容错（BFT）数十年的科学进步，实现了互联网设置所需的强大的可扩展性和安全性。 LibraBFT进一步完善了HotStuff协议，引入了明确的活跃度机制，并提供了具体的延迟分析。 为了推动与Libra Blockchain的集成，本文档提供了从全功能模拟器中提取的规范。 这些规范包括状态复制接口和用于参与者之间的数据传输和状态同步的通信框架。 最后，本报告提供了一个正式的安全证明，它引出了检测BFT节点不良行为的标准，同时还有一个简单的奖励和惩罚机制。

# 1 介绍

互联网和移动宽带的出现使全球数十亿人接触，提供知识，免费通信和各种低成本，更便捷的服务。 这种连接还使更多人能够访问金融生态系统。 然而，尽管取得了这些进展，但对于那些最需要金融服务的人来说，获得金融服务仍然有限。

区块链和加密货币表明，计算机科学，密码学和经济学的最新进展有可能在金融基础设施方面创造创新，但现有系统尚未达到主流应用。 作为实现这一目标的下一步，我们设计了Libra Blockchain [1]，[2]，目的是建立一个简单的全球货币和金融基础设施，为数十亿人提供支持。

这个新区块链的核心是一个名为LibraBFT的共识协议 - 本报告的重点 - 通过该协议对区块链交易进行排序和最终确定。 LibraBFT在参与共识协议的一组验证器中分散信任。 LibraBFT保证就诚实验证者之间的交易历史达成共识，即使参与者的门槛是拜占庭（即有缺陷或腐败[3]），它仍然是安全的。 通过采用经典的拜占庭容错方法，LibraBFT建立在分布式计算中坚实且经过严格验证的基础之上。 此外，科学界已经在LibraBFT的基础上取得了稳步进展，在扩展共识技术方面，并使其在互联网环境中保持稳健。

最初，参与的验证者将被允许进入共识网络，该协会由地理上分布的和不同的创始成员组成，这些成员是根据客观成员标准选择的组织，具有引导Libra生态系统的既得利益[2]。 随着时间的推移，会员资格将变为开放，仅基于组织持有Libra[4]。

LibraBFT的共识基于一种名为HotStuff的前沿技术[5]，[6]，它在BFT共识和区块链的世界之间架起了桥梁。 这种选择反映了丰富的专业知识和各种替代方案的探索，并为LibraBFT提供了以下关键属性，这些属性对于分散信任至关重要：

<!--more-->  

- **安全性：** LibraBFT保持诚实验证者之间的一致性，即使多达三分之一的验证者作恶。

- **异步：** 即使在网络异步的情况下（即，在无限制的通信延迟或网络中断期间），也保证一致性。 这反映了我们的信念，即构建互联网规模的共识协议，其安全性依赖于同步，本质上既复杂又容易受到网络上的拒绝服务（DoS）攻击。

- **不可改变性：** LibraBFT支持不可改变性概念，即交易变得不可逆转。 它提供了简明的承诺，用于向最终用户验证分类帐查询的结果。

- **线性和响应性：** LibraBFT有两个理想的属性，HotStuff之前的BFT共识协议无法同时支持 - 线性和响应性。 这两个技术概念与领导者的概念相关联，这是推动部分同步进展的关键方法。 非正式地，线性保证即使领导者轮换，推动交易提交也只会产生线性通信（这是最优的）; 响应性意味着领导者在收集来自验证者的响应时没有内置的延迟步骤和进展。

- **简单性和模块性：** LibraBFT的核心逻辑允许简单而强大的实现，与基于Nakamoto共识的公共区块链相似[7]。 值得注意的是，该协议围绕单个通信阶段进行组织，并允许简明的安全性参数。

- **可持续性：** 据报道，信任基于计算能力的当前公共区块链消耗大量能量[8]，可能需要集中化[9]。 LibraBFT被设计为股权证明系统，其中参与特权基于其财务参与被授予已知成员。 LibraBFT可以支持经济激励措施，以奖励良好行为和/或惩罚利益相关者的错误行为。 LibraBFT中的计算成本主要包括加密签名，这是一种具有高效实现的标准概念。

**关键技术方法** LibraBFT是一个共识协议，在轮次中进行，在每轮中，在验证者中选择领导者。 如上所述，需要这种关键方法来推动部分同步的进展。 领导者提出一个由事务组成的新块，并将其发送给其他验证者，如果新块都是由有效事务组成，则验证者验证新块。一旦领导者收集了大多数选票，她就会将其发送给其他验证人。如果领导者未能提出有效的区块或者没有聚集足够的选票，则超时机制将强制进行新一轮，并且将从验证器中选择新的领导者。 这样，新块扩展了区块链。 最终，一个块将满足LibraBFT的提交规则，一旦发生这种情况，就会提交此块和任何先前的块。

**相关工作** 全面的调查超出了本手稿的范围（例如参见[10]  -  [12]）。 在这里，我们提到影响我们工作的关键概念和机制。 经典设置中的共识算法。 拜占庭共识问题由Lamport等人开创。 [3]，他还创造了拜占庭一词来模拟任意的，可能是恶意腐败的行为。 Lamport等人提出的解决方案的安全性。 依赖于同步，实际系统希望避免由于复杂性而导致的依赖性，并且因为它使系统暴露于DoS对安全的攻击。

代替同步假设，由Ben-Or [13]开创的随机算法保证了高概率的进步。 一系列研究逐渐提高了此类算法的可扩展性，包括[14]  -  [17]。 但是，大多数实际系统尚未纳入随机化。 在未来，LibraBFT可能会采用某些随机化来阻止自适应攻击。

Dwork等人介绍了一种不同的异步设置方法[18]，将安全（在任何时候）从活性（在同步期间）分开。Dwork等人引入了一个轮逐轮的范例，每一轮都由指定的领导者驱动。一旦诚实的领导者出现，就会在同步期间保证进展，并且在此之前，轮次会因超时而退役。 Dwork等人的方法（DLS）是迄今为止大多数实际BFT工作的基础，并且其性能得到了稳定的改进。 具体而言，它是Castro和Liskov [19]引入的第一个实用解决方案的基础，称为PBFT。在PBFT中，一个诚实的领导者在两个all-to-all的通信轮次中做出决定。除了最初的PBFT开源实现之外，该协议已经集成到BFT-SMaRt [20]中，最近已集成到FaB [21]中。Zyzzyva [22]为PBFT增加了一条乐观快速的轨道，当没有失败时，它可以在一轮中做出决定。Zyzzyva [22]为PBFT增加了一条乐观快速的轨道，当没有失败时，它可以在一轮中做出决定。Cachin [24]和Reiter [25]在共识协议中使用了使用门限加密的响应聚合，以all-to-collector和collector-to-all模式替换all-to-all通信模式，这种模式仅产生线性通信成本。门限签名聚合已被纳入几个基于PBFT的系统，包括Byzcoin [26]和SBFT [27]。 同样，LibraBFT结合了消息收集和快速签名聚合[28]。 与门限签名相比，LibraBFT中的签名聚合不需要分布式设置，并且以每个签名的每个节点一个额外比特的价格为选民提供经济激励。

两个区块链系统，Tendermint [29]和Casper [30]提出了一种新的PBFT变体，它简化了PBFT的领导者替换协议，使其仅具有线性通信成本（线性）。这些变体放弃了称为响应性的实用解决方案的标志性特征。非正式地，（乐观的）响应性允许当领导者在收到固定数量的消息时提出新的块而不是等待固定的延迟时。因此，Tendermint和Casper在实际的BFT解决方案中引入了一个权衡 - 它们具有线性或响应性，但不是两者兼而有之。LibraBFT所基于的HotStuff解决方案（以及其他最近的区块链，特别是具有名为PaLa [31]的变体的ThunderCore）解决了这种权衡，并提出了第一个具有两者的BFT共识协议。

在无权限的环境中达成共识。上面提到的所有作品都采用了允许的设置，即参与的玩家是事先知道的。 不同的是，在无权限的环境中，任何一方都可以加入并参与协议 - 这就是Nakamoto Consensus（NC）[7]旨在解决的问题 - 导致完全不同的协议结构。在NC中，交易（以块为单位）被链接并简单地通过工作证明传播到网络。确认是以概率方式定义的 - 块在历史中保留的概率与区块链中后续块的计算成本成正比。扩展现有供应链的奖励机制足以激励矿工接受当前的实际存在的链并迅速收敛于一个最长的分叉。Casper和HotStuff表现出类似的协议结构简单性。 他们将协议轮次嵌入到（可能是分支的）链中，并通过链的简单离线分析推断出提交决策。

几个区块链类似地基于直接非循环图（DAG）形式的块图，允许在将块发布到图中时具有更大的并发性，例如GHOST [32]，Conflux [33]，Blockmania [34]和Hashgraph [35]。我们对这些范例中的一些范例的经验表明，恢复图形信息并在参与者暂时失去连接后进行验证可能具有挑战性。 在LibraBFT中，只有领导者才能扩展链条; 因此，传播，恢复和验证图形信息很简单，基本上是线性的。

重温LibraBFT。 LibraBFT利用HotStuff（ArXiv版本[5]，出现在PODC'19 [6]中）并拥有上面四十年的工作所取得的许多好处。具体来说，LibraBFT采用DLS和PBFT循环方法，具有签名聚合，并具有线性和响应性。 我们还发现Casper和HotStuff的链结构导致了强大的实现和简洁的安全性参数。

与HotStuff本身相比，LibraBFT进行了许多增强。 LibraBFT提供了起搏器机制的详细规范和实现，参与者通过该机制同步轮次。这与活跃度分析相结合，该分析包含对交易承诺的具体约束。 LibraBFT包括验证者投票权（时期）的重新配置机制。它还描述了奖励提议者和选民的机制。 该规范允许导出安全和完整的标准来检测试图破坏安全性的验证者，从而使惩罚能够在将来纳入协议。 我们还详细阐述了验证者之间的数据传播协议，以同步其状态。

**组织：** 本报告的其余部分结构如下：我们首先介绍重要的概念和定义（第2节）以及如何在Libra区块链中使用LibraBFT（第3节）。本报告的其余部分结构如下：我们首先介绍重要的概念和定义（第2节）以及如何在Libra区块链中使用LibraBFT（第3节）。 然后，我们描述了LibraBFT及其网络通信层的核心数据类型（第4节）。接下来，我们将协议本身（第5节）提供足够的细节来准备安全证明（第6节）。 然后我们描述起搏器模块（第7节）并证明活力（第8节）。 最后，我们讨论了LibraBFT的经济激励（第9节），并在第10节中得出结论。

在这个初始报告中，需要代码的地方，我们选择使用Rust的最小子集作为协议的规范语言。我们提供在离散事件模拟环境中直接从我们的参考实现中提取的代码片段。 我们打算共享此模拟器的代码，并在后续版本的报告中提供实验结果。

# 2 概述和定义

我们首先描述LibraBFT的所需属性以及我们的状态机复制协议如何集成到Libra Blockchain中。

## 2.1 复制状态机










